cmake_minimum_required(VERSION 3.17)
project(AntivirusFYP C)

set(CMAKE_C_STANDARD 11)

# 1. Find GTK4 (Frontend)
find_package(PkgConfig REQUIRED)
pkg_check_modules(GTK4 REQUIRED gtk4)

include_directories(${GTK4_INCLUDE_DIRS})
link_directories(${GTK4_LIBRARY_DIRS})
add_definitions(${GTK4_CFLAGS_OTHER})

# 2. Add Executable with ALL Source Files
# We MERGE the files from the old makefile into this list.
add_executable(AntivirusUI 
    main.c              # The UI Entry point (Frontend)
    scan_core.c         # Backend Logic
    signature_scan.c    # Backend Logic (The scanning engine)
    sha2.c              # Hashing Algo (Required by backend)
    # NOTE: We DO NOT include scanner.c because it has a 'main()' function.
    # We cannot have two main() functions in one program.
)

# 3. Setup Properties (No Console Window)
set_target_properties(AntivirusUI PROPERTIES WIN32_EXECUTABLE true)

# 4. Link Libraries (Frontend + Backend)
target_link_libraries(AntivirusUI 
    ${GTK4_LIBRARIES}   # Links GTK4
    ws2_32              # Links Windows Sockets (Required by your backend makefile)
)