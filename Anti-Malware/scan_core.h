#ifndef SCAN_CORE_H
#define SCAN_CORE_H

#include <sys/stat.h>
#include <glib.h> // REQUIRED for GList

/* Return codes */
#define SCANCORE_OK          0
#define SCANCORE_MATCH       1
#define SCANCORE_HANDLED     2  // Indicates file was quarantined/removed
#define SCANCORE_FATAL_ERR  -1
#define SCANCORE_FILE_ERR   -2

// --- New Multi-Threading Scan List Structure ---
// Holds the paths collected in Phase 1
typedef struct {
    GList *paths;      // GList of char* (all file paths)
    int total_files;   // Total count of files found
} FilePathList;
// NEW: Functions for recursive path listing (Phase 1)
FilePathList* list_files_recursive(const char *path_to_scan);
void free_filepath_list(FilePathList *list);
/* Compute SHA-256 of a file (returns 0 on success) */
int compute_file_sha256(const char *path, unsigned char out_hash[32]);

#endif